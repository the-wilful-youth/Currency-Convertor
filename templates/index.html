<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Real-Time Currency Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="bg-white p-8 rounded-xl shadow-lg w-96">
      <h2 class="text-2xl font-bold text-center mb-6">Currency Converter</h2>

      <label class="block text-gray-700">Amount:</label>
      <input
        type="number"
        id="amount"
        class="w-full p-2 border rounded mb-4"
        placeholder="Enter amount"
        value="1"
      />

      <label class="block text-gray-700">From:</label>
      <select
        id="from_currency"
        class="w-full p-2 border rounded mb-4"
      ></select>

      <label class="block text-gray-700">To:</label>
      <select id="to_currency" class="w-full p-2 border rounded mb-4"></select>

      <button
        onclick="convert()"
        class="w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600"
      >
        Convert
      </button>

      <h3 id="result" class="text-xl font-semibold text-center mt-4">
        Converted Amount:
      </h3>
    </div>

    <script>
      async function loadCurrencies() {
        const response = await fetch("/currencies");
        const data = await response.json();
        const fromCurrency = document.getElementById("from_currency");
        const toCurrency = document.getElementById("to_currency");

        for (const code in data.currencies) {
          let option1 = new Option(`${code} - ${data.currencies[code]}`, code);
          let option2 = new Option(`${code} - ${data.currencies[code]}`, code);
          fromCurrency.add(option1);
          toCurrency.add(option2);
        }
        fromCurrency.value = "USD";
        toCurrency.value = "INR";
      }

      async function convert() {
        const amount = document.getElementById("amount").value;
        const fromCurrency = document.getElementById("from_currency").value;
        const toCurrency = document.getElementById("to_currency").value;

        const response = await fetch(
          `/convert?from=${fromCurrency}&to=${toCurrency}&amount=${amount}`
        );
        const data = await response.json();

        document.getElementById(
          "result"
        ).innerText = `Converted Amount: ${data.converted_amount} ${toCurrency}`;
      }

      loadCurrencies();
    </script>
  </body>
</html>
